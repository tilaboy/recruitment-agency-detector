# first model (foo)
devel:
  0.967	0.936	0.951

Predicted   no  yes
Actual
no         954    8
yes         98  939

unindentified:
	1.000	0.897	0.945

Predicted   no   yes
Actual
yes        744  3870

annotated
  0.870	0.886	0.878

Predicted    no   yes
Actual
no         3814   282
yes         792  3305


# trained longer (20, en_core_web_sm)
0.979	0.961	0.970

Predicted   no   yes
Actual
no         917    45
yes         34  1003

unindentified	1.000	0.923	0.960

Predicted   no   yes
Actual
yes        284  4330

annotated	0.862	0.915	0.888

Predicted    no   yes
Actual
no         3303   793
yes         280  3817

# tf: cnn, one layer
eval    0.953   0.977   0.965

Predicted    0     1
Actual
0          912    50
1           24  1013

unindentified   1.000   0.893   0.944

Predicted    0     1
Actual
1          492  4122

annotated       0.832   0.910   0.869

Predicted     0     1
Actual
0          3342   754
1           370  3727

# tf: cnn, multiple layers
eval    0.983   0.959   0.971

Predicted    0    1
Actual
0          945   17
1           42  995


unindentified   1.000   0.911   0.953

Predicted    0     1
Actual
1          412  4202

annotated       0.846   0.906   0.875

Predicted     0     1
Actual
0          3420   676
1           385  3712


# tf: simple lstm
eval    0.901   0.943   0.921
I [2019-09-03 16:04:12,863] [tk_nn_classifier] Confusion matrix:
Predicted    0    1
Actual
0          854  108
1           59  978


unindentified   1.000   0.918   0.957
I [2019-09-03 16:03:04,564] [tk_nn_classifier] Confusion matrix:
Predicted    0     1
Actual
1          377  4237


annotated       0.770   0.916   0.837
I [2019-09-03 16:04:08,662] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          2977  1119
1           343  3754



# tf: multi-layer lstm
difficult to train and restult are not reliable yet


# training on big set:
spacy
unindentified   1.000   0.915   0.956
Predicted   no   yes
Actual
yes        434  4180

annotated       0.993   0.990   0.992
Predicted    no   yes
Actual
no         4077    19
yes          58  4039

us     0.946   0.138   0.241
Predicted    no  yes
Actual
no         9921   79
yes        9092  908

tf_cnn_simple
unindentified	1.000	0.936	0.967
Predicted    0     1
Actual
1          297  4317

annotated	0.972	0.985	0.979
Predicted     0     1
Actual
0          3981   115
1            62  4035

eval 	0.986	0.987	0.987
Predicted    0     1
Actual
0          947    15
1           13  1024

us  	0.922	0.697	0.794
Predicted     0     1
Actual
0          9409   591
1          3026  6974

# retrain: cnn-simple on train_big, test on eval_big
accuracy': 0.8910116, 'auc': 0.8908284, 'loss': 0.28237858, 'global_step': 2900

- unindentified:
label   Prec    Reca     F1
  0     0.000   0.000   0.000
  1     1.000   0.923   0.960

Predicted    0     1
Actual
1          355  4259

- annotated:
label   Prec    Reca     F1
  0     0.919   0.815   0.864
  1     0.834   0.928   0.878
I [2019-11-29 16:43:24,058] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          3338   758
1           294  3803

- eval:
label   Prec    Reca     F1
  0     0.947   0.861   0.902
  1     0.881   0.956   0.917
I [2019-11-29 16:43:44,298] [tk_nn_classifier] Confusion matrix:
Predicted    0    1
Actual
0          828  134
1           46  991


- random:
label   Prec    Reca     F1
  0     0.633   0.216   0.322
  1     0.538   0.879   0.667
I [2019-11-29 16:45:28,663] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          1142  4138
1           663  4810

- us:
label   Prec    Reca     F1
  0     0.649   0.828   0.728
  1     0.763   0.552   0.640
I [2019-11-29 16:47:06,263] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          8284  1716
1          4482  5518

# retrain with uppercase everywhere:
accuracy': 0.9680551, 'auc': 0.9680475, 'loss': 0.11155169, 'global_step': 1300

- unidentified:
label   Prec    Reca     F1
  0     0.000   0.000   0.000
  1     1.000   0.959   0.979
I [2019-11-29 17:03:28,179] [tk_nn_classifier] Confusion matrix:
Predicted    0     1
Actual
1          188  4426


- annotated:
label   Prec    Reca     F1
  0     0.981   0.950   0.965
  1     0.952   0.981   0.966
I [2019-11-29 17:04:44,830] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          3892   204
1            77  4020

- eval:
label   Prec    Reca     F1
  0     0.987   0.974   0.981
  1     0.976   0.988   0.982
I [2019-11-29 17:05:02,664] [tk_nn_classifier] Confusion matrix:
Predicted    0     1
Actual
0          937    25
1           12  1025


- random:
label   Prec    Reca     F1
  0     0.848   0.221   0.351
  1     0.561   0.962   0.709
I [2019-11-29 17:06:32,817] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          1169  4111
1           210  5263

- us:
label   Prec    Reca     F1
  0     0.748   0.937   0.832
  1     0.916   0.685   0.783
I [2019-11-29 17:08:09,777] [tk_nn_classifier] Confusion matrix:
Predicted     0     1
Actual
0          9369   631
1          3154  6846
